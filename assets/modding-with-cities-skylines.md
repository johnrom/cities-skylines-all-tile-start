# Modding with Cities: Skylines

## 10,000 foot overview of Unity and .Net

The .Net platform a set of technologies consisting of standards for interoperable code.

- Code is written in C#, F# or a variety of languages which satisfy the Common Language Specification (CLS).
- Any CLS-compatible language can be compiled to Common Intermediate Language (CIL) code which can be executed by the Common Language Runtime (CLR).
  - This is called the Common Language Infrastructure (CLI).

Unity is an engine that uses a `Common Language`-compatible compiler (`Mono`) to compile scripts for games down to a CIL assembly (`.dll`) that can be consumed by the `CLR` -- in our example `.Net Framework 3.5` or `Mono 3.5`. During the final build of the game, this is generally converted from `CIL` to native binaries for a given environment (Windows, Mac, etc) before you download and run it.

```
Language 
  -> Compiler Implementation (.Net SDK or Mono Compiler) 
    -> Intermediate Language (.dll)
      -> Runtime (.Net Runtime or Mono Runtime)
        -> Native Binary, OR
      -> Compile directly to Native Binary
```

### Target Framework Moniker (TFM)

The target framework defines the implementation or abstraction of .Net that you'll be using. Any compiler which supports the target framework can be used to generate code that will run with the .Net Runtime. The Target Framework Moniker or TFM is the name used in code to identify the target framework.

There have been many different target frameworks over the past few years:

| Target Framework | TFM |
| ---------------- | --- |
| `.Net Framework 3.5` | `net35` |
| `.Net Framework 4.5-4.8` | `net451`, `net462`, `net48`, etc |
| `.Net Core 1.0-3.1` | `netcoreapp3.1`, etc |
| `.Net Standard 1.0-2.1` | `netstandard2.1`, etc |
| `.Net 5-6` | `.net6.0`, etc |

In the process of making `.Net Framework` cross-platform and open source, Microsoft created somewhat of a fork called `.Net Core`, and an abstraction called `.Net Standard` which was compatible with both .Net Framework and .Net Core Target Frameworks. Now, all new `.Net` is generally built on `.Net`, which is also backwards-compatible with `.Net Standard`.

Cities Skylines is built with a version of Unity compatible with `.Net Framework 3.5`, so none of the new features, forks, fanciness, or confusion applies to us. We cannot even target `.Net Standard` as that wasn't introduced until `.Net Framework 4.6`, `Mono 4.6`, and `Unity 2018.1`. We'll be using a very old .Net version that isn't really supported by Visual Studio. This is very important!

> I've read that Cities: Skylines uses a modified version of Unity, so it's very unlikely that the developers will ever update Unity or support a `.Net`- or `.Net Standard`-compatible TFM for modding.

## How a Mod Works

Cities: Skylines is able to take the Intermediate Language (CIL) generated by mods and incorporate them into the game during runtime. Thus, when writing a mod, we follow a similar process to writing a Unity game itself, or any other .Net project:

- write code targeting the TFM `.Net Framework 3.5`
- build `.dll` CIL assemblies for the CLR. 
- push them into the Mods folder within Cities' Skylines directory.
- Cities: Skylines will detect the new `.dll`s and make them available within the game.

> Cities: Skylines uses CIL code for mods, so we do not need to generate native binaries.

When we're ready to go live, we upload this built version to Steam. When a user subscribes, the assembly is downloaded to their Mods folder.
